0 RUN6000010 X=38:Y=2320 DIM L(X-1,Y-1):DIM D(4):DIM Z((X-1)*(Y-1))30 PRINT"“"40 V=0:FORI=-1TOX:J=-1:GOSUB50000:J=Y:GOSUB50000:NEXT50 FORJ=0TOY-1:I=-1:GOSUB50000:I=X:GOSUB50000:NEXT60 FORJ=0TOY-1:FORI=0TOX-1:L(I,J)=0:V=L(I,J):GOSUB50000:NEXTI:NEXTJ70 R=RND(TI):PX=INT(RND(1)*X):PY=INT(RND(1)*Y)80 L(PX,PY)=1:V=L(PX,PY):I=PX:J=PY:GOSUB50000100 ND=0110 IFPX>0THENIFL(PX-1,PY)=0THEND(ND)=1:ND=ND+1120 IFPX<X-1THENIFL(PX+1,PY)=0THEND(ND)=2:ND=ND+1130 IFPY>0THENIFL(PX,PY-1)=0THEND(ND)=3:ND=ND+1140 IFPY<Y-1THENIFL(PX,PY+1)=0THEND(ND)=4:ND=ND+1150 IF ND=0 THEN 1000200 R=INT(RND(1)*ND)210 IFD(R)=1THEN300220 IFD(R)=2THEN400230 IFD(R)=3THEN500240 IFD(R)=4THEN600250 PRINT"ERREUR 250":END300 REM GAUCHE310 L(PX,PY)=L(PX,PY)OR1315 GOSUB 900320 PX=PX-1330 L(PX,PY)=L(PX,PY)OR4340 GOSUB900350 GOTO 100400 REM DROITE410 L(PX,PY)=L(PX,PY)OR4415 GOSUB 900420 PX=PX+1430 L(PX,PY)=L(PX,PY)OR1440 GOSUB900450 GOTO 100500 REM HAUT510 L(PX,PY)=L(PX,PY)OR2515 GOSUB 900520 PY=PY-1530 L(PX,PY)=L(PX,PY)OR8540 GOSUB900550 GOTO 100600 REM BAS610 L(PX,PY)=L(PX,PY)OR8615 GOSUB 900620 PY=PY+1630 L(PX,PY)=L(PX,PY)OR2640 GOSUB900650 GOTO 100900 REM AFFICHAGE910 I=PX:J=PY:V=L(PX,PY):GOSUB50000920 RETURN1000 REM RECHERCHE NOUVEAU POINT DE DEPART1010 NZ=01020 FORI=0TOX-11030 FORJ=0TOY-11040 IF L(I,J)=0THEN12001050 IF I>0 THEN IF L(I-1,J)=0 THEN 11501060 IF J>0 THEN IF L(I,J-1)=0 THEN 11501070 IF I<X-1 THEN IF L(I+1,J)=0 THEN 11501080 IF J<Y-1 THEN IF L(I,J+1)=0 THEN 11501140 GOTO 12001150 Z(NZ)=I+J*X1160 NZ=NZ+11200 NEXTJ1210 NEXTI1300 IF NZ=0 THEN 14001305 R=INT(RND(1)*NZ)1310 PY=INT(Z(R)/X)1320 PX=Z(R)-PY*X1330 GOTO 1001400 REM FINI...1410 R=INT(RND(1)*Y)1420 L(0,R)=L(0,R)OR11430 I=0:J=R:V=L(0,R):GOSUB500001440 I=-1:J=R:V=5:GOSUB500001510 R=INT(RND(1)*Y)1520 L(X-1,R)=L(X-1,R)OR41530 I=X-1:J=R:V=L(X-1,R):GOSUB500001540 I=X:J=R:V=5:GOSUB500001900 GOTO 190010000 END50000 C=1065+I+40*J50010 IFV= 0THENPOKEC,160:RETURN50020 IFV= 1THENPOKEC,238:RETURN50030 IFV= 2THENPOKEC,253:RETURN50040 IFV= 4THENPOKEC,237:RETURN50050 IFV= 8THENPOKEC,240:RETURN50060 IFV= 6THENPOKEC,237:RETURN50070 IFV= 7THENPOKEC,241:RETURN50080 IFV= 3THENPOKEC,253:RETURN50090 IFV= 5THENPOKEC,192:RETURN50100 IFV= 9THENPOKEC,238:RETURN50110 IFV=10THENPOKEC,194:RETURN50120 IFV=11THENPOKEC,243:RETURN50130 IFV=12THENPOKEC,240:RETURN50140 IFV=13THENPOKEC,242:RETURN50150 IFV=14THENPOKEC,235:RETURN50160 IFV=15THENPOKEC,219:RETURN50990 POKEC,3250999 RETURN60000 SAVE"@0:LABY OK",8:RUN10